---
title: "0111-0117"
tag: TIL
category: TIL
---
## 0111
# 새로운 프로젝트


오늘부터 인공지능 포털 사이트 개발 프로젝트에 참여하여 풀스택 영역을 다루기로 했다.  
우선 백엔드 API개발부터 시작하였다.

---

* 기존에 개발하던 API를 인수인계 받고 설명을 들었다.
* 스토리 보드를 참조하여 내가 할 일을 정하고, 어떻게 구현할지 고민했다.
* 개발 환경을 구축하고, 서버를 올리는 데 성공하였다.
* 스프링 부트에 대한 정보를 찾아보며 기본적인 흐름에 대해 이해하였다.

## 0112
* 회원과 관련된 API 개발을 맡아서 하게 되었다.
* 회원가입과 회원탈퇴하는 API를 생성했다.
* 회원가입 시 비밀번호를 SHA-256을 이용하여 암호화 해서 DB에 저장하였다.

```java
public class SHA256Util {
    /**
     * SHA-256 암호화 함
     * @param source 원본
     * @param salt(String) SALT 값
     * @return
     */
    public static String getEncrypt(String source, String salt) {
        return getEncrypt(source, salt.getBytes());
    }

    /**
     * SHA-256 암호화 함
     * @param source 원본
     * @param salt(byte[]) SALT 값
     * @return
     */
    public static String getEncrypt(String source, byte[] salt) {

        String result = "";

        byte[] a = source.getBytes();
        byte[] bytes = new byte[a.length + salt.length];

        System.arraycopy(a, 0, bytes, 0, a.length);
        System.arraycopy(salt, 0, bytes, a.length, salt.length);

        try {
            // 암호화 방식 지정 메소드
            MessageDigest md = MessageDigest.getInstance("SHA-256");
            md.update(bytes);

            byte[] byteData = md.digest();

            StringBuffer sb = new StringBuffer();
            for (int i = 0; i < byteData.length; i++) {
                sb.append(Integer.toString((byteData[i] & 0xFF) + 256, 16).substring(1));
            }

            result = sb.toString();
        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
        }

        return result;
    }
}

//사용
        String password = user.getPassword();
        password = SHA256Util.getEncrypt(password, salt);

        user.setPassword(password);
```

**처음으로 실제 프로젝트에서 사용하는 API를 개발하다보니 생각보다 고민해야 할 부분도 많았고, 코딩을 하기 전에 설계 측면에서 더 깊게 생각해야 한다는 것을 느꼈다.**

## 0113
* 비즈니스 형식으로 이메일을 작성해보고 이를 이용해 정보를 공유했다.
* 로그인 시 쿠키를 생성해서 필요한 정보들을 쿠키에 저장하였다.
* 그리고 쿠키를 이용해서 백엔드 로직을 구현하였다.

```java
 Cookie[] loginCookies = new Cookie[4];  // 쿠키 설정
loginCookies[0] = new Cookie("email", login.getEmail());
loginCookies[1] = new Cookie("userNo", login.getUserNo() + "");
loginCookies[2] = new Cookie("userGbCode", login.getUserGbCode());
loginCookies[3] = new Cookie("userName", login.getUserName());

for (Cookie c : loginCookies) {
    c.setPath("/");
    c.setMaxAge(-1);
    response.addCookie(c);
}

//쿠키정보를 체크해서 회원인지를 확인한다. user.email과 쿠키에 있는 이메일이 같은지 확인하다.
Cookie[] cookies = request.getCookies();
if(cookies != null) {
    for(Cookie c : cookies){
        if ("email".equals(c.getName())) {
            cookieEmail = c.getValue();
        }
    }
}
int emailCnt = userService.dupEmail(user); //DB에 이메일이 존재하면 1, 없으면 0 반환
if (emailCnt > 0) {
    if(user.getEmail() == cookieEmail) {
        //회원탈퇴처리
        userService.withdraw(user);
        //회원탈퇴가 제대로 처리 되면 쿠키를 삭제한다.
        if (cookies != null) { // 쿠키가 한개라도 있으면 실행
            for (Cookie c : cookies) {
                c.setMaxAge(0); // 유효시간을 0으로 설정
                c.setPath("/");
                response.addCookie(c); // 응답 헤더에 추가
            }
        }
    }
}
```

**쿠키는 이전에도 학습했던 적이 있는데, 직접 프로젝트에 사용해보니 조금 더 이해가 잘 되었다. 쿠키를 이용해서 API에 접근하는 권한을 확인하였다.**

## 0114
* 오늘은 스스로 여러가지 상황을 생각해서 오류 코드를 작성하였다.
* API를 작성하는데 기본이 되는 연동규격 정의서를 작성하고, 그에 맞게 API를 개발하였다.
* 직접 돌아가는 코드를 확인하고, 테스트를 시도하여 회원의 기본적인 CRUD를 할 수 있도록 설계 및 개발하였다.
* 로그인 시 쿠키를 생성할 때, 'UTF-8'형식으로 인코딩하여 디코딩 시 예상한 결과가 출력되도록 코딩하였다.